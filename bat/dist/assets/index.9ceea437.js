import{L as b,j as a,X as y,a as C}from"./setPrototypeOf.96237ccd.js";import{u as U,M as Y}from"./robot.3e6e89fc.js";import{u as Z,a as ee,b as se,c as te,R as ae}from"./usePopulateVerbsTensesForms.75661281.js";import{s as P,_ as ne,g as w,e as A,h as F,i as I,as as D,at as R,f as Q,j as oe,k as re,au as le,av as ie,aw as ce,ax as ue,b as E,O as de,Q as he,u as me,a as _,d as be,W as pe,H as fe,S as ge,P as ve,ay as Se,B as u,T as f,A as xe,C as k}from"./App.f6db2e07.js";import{b as ye}from"./index.e2051f0b.js";import{c as ke,S as Te}from"./usePushRandomResponse.86bf4329.js";import{B as V}from"./BatBox.77abe198.js";import"./index.module.99d47a0b.js";import"./translationGA.a39e0647.js";const Ce=async(n,s,o,e,t,r)=>{console.log("userID:",n);try{const{data:i,error:l}=await P.from("bat_chats").insert({user_id:n,verb:s,tense:o,form:e,questions:t,intro:r}).select("*").single();if(l)throw l;if(i)return i}catch(i){alert(i.message)}},we=async(n,s,o)=>{try{const{data:e,error:t}=await P.from("bat_questions").select("id").in("verb_id",n).in("tense_id",s).in("form_id",o);if(t)throw t;return e}catch(e){alert(e.message)}},Ae=()=>{const{profile:n}=ne(),{selectedVerb:s}=w(),{t:o}=A(),{selectedTense:e}=F(),{selectedForm:t}=I(),r=ke();return()=>{let l=r([],"filler","intro","greeting","naive",{name:n!==null&&n.username!==null?n.username:"there"});return l=r(l,"filler","intro","taskDescription","basic",{verb:s!==void 0?s.name:o("task.allVerbs"),tense:e!==void 0?e.name:o("task.allTenses"),form:t!==void 0?t.name:o("task.allForms")}),l=r(l,"filler","intro","questionDescription","basic",{}),l=r(l,"filler","intro","getReady","basic",{}),l}},T=({label:n,value:s,handleChange:o,items:e,all:t=!0,allDisplay:r=""})=>b(Te,{label:n,value:s,onChange:o,sx:{width:"100%",color:"#fff",textAlign:"center"},children:[t&&a(D,{value:"all",children:r},"all"),e.map((i,l)=>a(D,{value:i,children:i},l))]});function Fe(){const{selectedVerb:n}=w(),{selectedTense:s}=F(),{selectedForm:o}=I(),{setQuestionSet:e}=R(),{verbs:t}=Q(),{tenses:r}=oe(),{forms:i}=re();return()=>{const v=n!==void 0?[n.id]:t.map(d=>d.id),S=s!==void 0?[s.id]:r.map(d=>d.id),p=o!==void 0?[o.id]:i.map(d=>d.id);we(v,S,p).then(d=>{d!==void 0?e(d.map(g=>g.id)):console.log("question set undefined")})}}const Ie=(n,s)=>{const o=new Array(s);let e=n.length;const t=new Array(e);for(s>e&&(s=e);s--;){const r=Math.floor(Math.random()*e);o[s]=n[r in t?t[r]:r],t[r]=--e in t?t[e]:e}return o},De=()=>{const n=y(le),{selectedVerb:s,setSelectedVerb:o}=w(),e=y(ie),{selectedTense:t,setSelectedTense:r}=F(),i=y(ce),{selectedForm:l,setSelectedForm:v}=I(),{noQuestions:S}=ue(),{questionSet:p}=R(),[d,g]=C.exports.useState(!1),{chats:j,setChats:B}=E(),{setIntro:M}=de(),{setOutro:O}=he(),q=me(),{session:x}=_(),H=Fe(),G=Ae(),{setAdjacencyPairs:N}=be(),{setAnimatingOutro:W}=pe(),$=()=>{x!==null&&(g(!0),H())},{setMessageInputDisabled:z}=fe(),{t:h}=A(),{setShowAvailablePoints:L}=ge(),{setShowPoints:X}=ve(),{setShowHome:J}=Se();return C.exports.useEffect(()=>{if(p.length!==0&&x!==null&&d){g(!1),X(!1),J(!1),L(!0),M([]),O([]),N([]),z(!0),W(!1);const c=G(),m=Ie(p,S);Ce(x.user.id,s!==void 0?s.name:null,t!==void 0?t.name:null,l!==void 0?l.name:null,m,c).then(K=>{B([...j,K]),q(`${ye}chat`)})}console.log("availableVerbs:",n)},[p]),b(V,{children:[b(u,{children:[a(f,{align:"center",variant:"h6",children:h("headers.verb")}),a(u,{border:2,borderColor:"primary.dark",borderRadius:1.5,children:a(T,{handleChange:c=>{o(n.find(m=>m.name===c.target.value))},value:s!==void 0?s.name:"all",label:"Verbs",items:n.map(c=>c.name),allDisplay:h("task.allVerbs")})})]}),b(u,{mt:1,children:[a(f,{align:"center",variant:"h6",children:h("headers.tense")}),a(u,{border:2,borderColor:"primary.dark",borderRadius:1.5,children:a(T,{handleChange:c=>{r(e.find(m=>m.name===c.target.value))},value:t!==void 0?t.name:"all",label:"Tenses",items:e.map(c=>c.name),allDisplay:h("task.allTenses")})})]}),b(u,{mt:1,children:[a(f,{align:"center",variant:"h6",children:h("headers.form")}),a(u,{border:2,borderColor:"primary.dark",borderRadius:1.5,children:a(T,{handleChange:c=>{v(i.find(m=>m.name===c.target.value))},value:l!==void 0?l.name:"all",label:"Forms",items:i.map(c=>c.name),allDisplay:h("task.allForms")})})]}),a(u,{mt:3,children:a(V,{button:!0,width:"100%",children:a(xe,{size:"large",fullWidth:!0,label:h("buttons.start"),onClick:()=>{$()},selected:!0,color:"secondary"})})})]})},Ve=()=>{Z(),ee(),se();const{verbs:n}=Q(),{chats:s}=E(),{session:o}=_(),e=te(),t=U(),{i18n:r}=A();return C.exports.useEffect(()=>{n.length===0&&e(),s.length===0&&o!==null&&t(o.user.id)},[o]),b(u,{children:[a(Y,{title:"SetTask"}),a(k,{pt:2,children:a(ae,{})}),a(k,{py:1,px:2,flexDirection:"column",children:b(u,{width:"95%",height:150,children:[a(u,{width:"100%",height:"100%",sx:{display:r.language==="ga"?"block":"none"},children:a(f,{children:"Pioc briathar, aimsir, agus foirm. Cuirfidh m\xE9 5 gceist ort le 'l\xEDon na bearna\xED' iontu. Is f\xE9idir liom cabhr\xFA leat tr\xED nodanna agus molta\xED a thabhairt duit. T\xE1 10 bpointe ag dul ar gach ceist... An bhfuil t\xFA in ann 50 a shroichint?"})}),a(u,{width:"100%",height:"100%",sx:{display:r.language==="en"?"block":"none"},children:a(f,{children:"Choose a verb, tense, and form to practice. I will ask you 5 'fill in the blank' questions. I can help by giving hints and suggestions. There are 10 points per question... Can you score 50?"})})]})}),a(k,{children:a(De,{})})]})},qe=Ve;export{qe as default};
