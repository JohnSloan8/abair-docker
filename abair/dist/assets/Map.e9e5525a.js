import{R as l,a4 as f,d,a as h,aa as S,V as w,j as c}from"./setPrototypeOf.fd4aa278.js";import{d as U,a as W,b as J}from"./index.a59b930e.js";import{B as v,k as g,z as K,s as Q,o as X,p as Y,C as R,D as Z,q as ee,G as p,u as se,x as te,r as P,i as b,j as D,f as ne,a as ie,E as oe,J as ae}from"./App.dfbd2600.js";const I=l({key:"synthesis-audio-state",default:""}),E=()=>{const[e,s]=d(I);return{synthesisAudio:e,setSynthesisAudio:s}},re=l({key:"synthesis-audios-state",default:[]}),ce=()=>{const[e,s]=d(re);return{synthesisAudios:e,setSynthesisAudios:s}},ue=f({key:"synthesis-audio-empty-state",get:({get:e})=>!(e(I).length>0)}),le=l({key:"synthesis-audio-playing-state",default:!1}),de=()=>{const[e,s]=d(le);return{synthesisAudioPlaying:e,setSynthesisAudioPlaying:s}},ye=l({key:"awaiting-synthesis-state",default:!1}),x=()=>{const[e,s]=d(ye);return{awaitingSynthesis:e,setAwaitingSynthesis:s}},G=l({key:"synthesis-text-state",default:""}),N=()=>{const[e,s]=d(G);return{synthesisText:e,setSynthesisText:s}},he=f({key:"synthesisTextEmptyStringState",get:({get:e})=>!(e(G).length>0)}),L=l({key:"synthesis-voice-index",default:-1}),Se=()=>{const[e,s]=d(L);return{synthesisVoiceIndex:e,setSynthesisVoiceIndex:s}},C=l({key:"synthesis-voice-options-state",default:[]}),fe=()=>{const[e,s]=d(C);return{synthesisVoices:e,setSynthesisVoices:s}},pe=l({key:"synthesis-pitch",default:1}),ge=()=>{const[e,s]=d(pe);return{synthesisPitch:e,setSynthesisPitch:s}},me=l({key:"synthesis-speed",default:1}),ve=()=>{const[e,s]=d(me);return{synthesisSpeed:e,setSynthesisSpeed:s}},O=l({key:"synthesis-county",default:"Connemara"}),xe=()=>{const[e,s]=d(O);return{synthesisCounty:e,setSynthesisCounty:s}},j=l({key:"synthesis-Model",default:""}),Ce=()=>{const[e,s]=d(j);return{synthesisModel:e,setSynthesisModel:s}},F=l({key:"synthesis-gender",default:"female"}),_e=()=>{const[e,s]=d(F);return{synthesisGender:e,setSynthesisGender:s}},z=f({key:"synthesis-voice-selected",get:({get:e})=>{const s=e(L),a=e(C);if(s!==-1)return a[s]}}),Be=f({key:"synthesis-model-options",get:({get:e})=>{const s=e(z);return s!==void 0?s.voices:[]}}),Ae=f({key:"synthesis-voice-options",get:({get:e})=>{const s=e(C),a=e(O),i=e(F),u=e(j),y=n=>{switch(a){case"Ulster":return n.filter(t=>t.locale==="Ulster");case"Connemara":return n.filter(t=>t.locale==="Connemara");case"Munster":return n.filter(t=>t.locale==="Munster");default:return n}},o=n=>{switch(i){case"male":return n.filter(t=>t.gender==="male");case"female":return n.filter(t=>t.gender==="female");default:return n}},r=n=>{switch(u){case"HTS":return n.filter(t=>t.voices.includes("HTS"));case"DNN":return n.filter(t=>t.voices.includes("DNN"));case"HTS-WORLD":return n.filter(t=>t.voices.includes("HTS-WORLD"));case"NEMO":return n.filter(t=>t.voices.includes("NEMO"));default:return n}};if(s!==void 0&&s.length!==0){const n=y(s),t=o(n);return r(t)}else return}}),ke=()=>{const[e,s]=h.exports.useState(!0),{synthesisAudio:a}=E(),i=S(ue),{awaitingSynthesis:u}=x(),{synthesisAudioPlaying:y,setSynthesisAudioPlaying:o}=de(),r=h.exports.useRef(null),n=()=>{r.current!==void 0?r.current!==null?(r.current.play(),o(!0)):console.log("audio.current === null"):console.log("audio.current === undefined")},t=()=>{console.log("in stop"),r.current!==void 0?r.current!==null?(r.current.pause(),o(!1)):console.log("audio.current === null"):console.log("audio.current === undefined")};return h.exports.useEffect(()=>{e?s(!1):n()},[a]),w(v,{sx:{visibility:i||u?"hidden":"visible"},children:[y?c(g,{color:"secondary",onClick:()=>{t()},icon:W}):c(g,{color:"secondary",onClick:()=>{n()},icon:U}),c("audio",{src:a,ref:r,onEnded:t})]})},Me=e=>e==="Connemara"?"ga_CO":e==="Ulster"?"ga_UL":"ga_MU",Ve=e=>e==="NEMO"?"nemo":e==="DNN"?"nnmnkwii":e==="HTS"?"exthts":e==="HTS-WORLD"?"exthts-WORLD":"",Te=async(e,s,a,i,u)=>{console.log("currentVoice:",s),console.log("pitch:",i);const y=Ve(a),o=Me(s.locale)+"_"+s.shortCode+"_"+y;console.log("voiceName:",o);try{const{data:r}=await J({method:"post",url:K,headers:{"Content-Type":"application/json"},data:{synthinput:{text:e,ssml:"string"},voiceparams:{languageCode:"ga-IE",name:o,ssmlGender:"UNSPECIFIED"},audioconfig:{audioEncoding:"LINEAR16",speakingRate:u,pitch:i,volumeGainDb:1,htsParams:"string",sampleRateHertz:0,effectsProfileId:[]},outputType:"JSON"},timeout:1e4});if(r)return r}catch(r){return alert("error:"+r),!1}},we=async e=>{try{const{error:s}=await Q.from("synthesis_requests").insert([e]);if(s)throw s}catch(s){alert(s.message)}},Re=()=>{const{sessionID:e}=X(),{session:s}=Y(),{synthesisText:a}=N(),{setSynthesisAudio:i}=E(),{setSynthesisAudios:u}=ce(),y=S(he),o=S(z),r=S(Ae),{synthesisVoiceIndex:n}=Se(),{awaitingSynthesis:t,setAwaitingSynthesis:m}=x(),{synthesisModel:k,setSynthesisModel:H}=Ce(),{synthesisPitch:M}=ge(),{synthesisSpeed:V}=ve();return h.exports.useEffect(()=>{r!==void 0&&r.length},[r]),h.exports.useEffect(()=>{o!==void 0&&H(o.voices[o.voices.length-1])},[o]),c(R,{children:t?c(ee,{}):c(g,{disabled:y||n===-1,color:"secondary",onClick:()=>{m(!0),i(""),o!==void 0&&Te(a,o,k,M,V).then(T=>{i("data:audio/wav;base64,"+T.audioContent),u(q=>[{voice:o.name,model:k,speed:V.toString(),pitch:M.toString(),audioData:"data:audio/wav;base64,"+T.audioContent,text:a},...q]),m(!1),we({user_id:s===null?null:s.user.id,session_ID:e,text:a})})},icon:Z})})},$e=()=>c(v,{sx:{width:"100%",height:"100%",position:"relative"},children:w(p,{container:!0,direction:"row",height:"100%",children:[c(p,{item:!0,xs:4}),c(p,{item:!0,xs:4,children:c(Re,{})}),c(p,{item:!0,xs:4,children:c(R,{children:c(ke,{})})})]})}),He=({rows:e=4})=>{const{synthesisText:s,setSynthesisText:a}=N(),{awaitingSynthesis:i}=x(),{t:u}=se(),{synthesisVoices:y}=fe();return h.exports.useEffect(()=>{y.length},[]),c(te,{label:u("pages.home.writeHere"),rows:e,disabled:!!i,autoFocus:!1,value:s,onChange:o=>{a(o)}})};var _={},Pe=b.exports;Object.defineProperty(_,"__esModule",{value:!0});var B=_.default=void 0,be=Pe(P()),De=D,Ie=(0,be.default)((0,De.jsx)("path",{d:"M17.5 9.5C17.5 6.46 15.04 4 12 4S6.5 6.46 6.5 9.5c0 2.7 1.94 4.93 4.5 5.4V17H9v2h2v2h2v-2h2v-2h-2v-2.1c2.56-.47 4.5-2.7 4.5-5.4zm-9 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5z"}),"Female");B=_.default=Ie;var A={},Ee=b.exports;Object.defineProperty(A,"__esModule",{value:!0});var $=A.default=void 0,Ge=Ee(P()),Ne=D,Le=(0,Ge.default)((0,Ne.jsx)("path",{d:"M9.5 11c1.93 0 3.5 1.57 3.5 3.5S11.43 18 9.5 18 6 16.43 6 14.5 7.57 11 9.5 11zm0-2C6.46 9 4 11.46 4 14.5S6.46 20 9.5 20s5.5-2.46 5.5-5.5c0-1.16-.36-2.23-.97-3.12L18 7.42V10h2V4h-6v2h2.58l-3.97 3.97C11.73 9.36 10.66 9 9.5 9z"}),"Male");$=A.default=Le;const qe=()=>{const{synthesisGender:e,setSynthesisGender:s}=_e();return c(v,{children:[{name:"male",icon:$},{name:"female",icon:B}].map(i=>c(g,{selected:i.name===e,color:"secondary",onClick:()=>{s(i.name)},icon:i.icon},i.name))})},Ue=()=>{const{synthesisCounty:e,setSynthesisCounty:s}=xe(),a=["Ulster","Connemara","Munster"],i=S(ne),{breakpointSize:u}=ie(),y=oe();return c(ae,{height:y.pathname==="/speech-synthesis"?u==="xs"?260:340:u==="xs"?i-90:i-65,gaeltachts:a,selectedCounty:e,setSelectedCounty:o=>s(o)})};export{qe as G,Ue as M,He as S,ge as a,$e as b,ce as c,Ce as d,Se as e,z as f,Ae as g,fe as h,Be as s,ve as u};
