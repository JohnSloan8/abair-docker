import{_ as y,X as h,a as u,L as z,j as s,R as M,d as B,V as g}from"./setPrototypeOf.fd4aa278.js";import{Q as E,P as Y,R as A,a1 as X,ag as q,ah as O,ai as R,U as Q,aj as G,ak as Z,X as J,Y as F,Z as K,s as x,p as ee,ac as te,c as ae,af as U,H as se,B as w,A as re,C as V,G as v,ad as L,al as T,am as D,an as _,ae as oe,v as ie,w as ne}from"./App.385b290f.js";import{M as le}from"./Meta.c79f7c62.js";import{d as N}from"./dividerClasses.d41542d0.js";import"./index.2ece1894.js";import"./index.module.01fcbc19.js";function de(e){return Y("MuiMenuItem",e)}const ce=E("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),b=ce,ue=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],pe=(e,t)=>{const{ownerState:o}=e;return[t.root,o.dense&&t.dense,o.divider&&t.divider,!o.disableGutters&&t.gutters]},fe=e=>{const{disabled:t,dense:o,divider:i,disableGutters:d,selected:r,classes:l}=e,p=K({root:["root",o&&"dense",t&&"disabled",!d&&"gutters",i&&"divider",r&&"selected"]},de,l);return y({},l,p)},ge=A(X,{shouldForwardProp:e=>q(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:pe})(({theme:e,ownerState:t})=>y({},e.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!t.disableGutters&&{paddingLeft:16,paddingRight:16},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${b.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:h(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${b.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:h(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${b.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:h(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:h(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${b.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${b.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${N.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${N.inset}`]:{marginLeft:52},[`& .${R.root}`]:{marginTop:0,marginBottom:0},[`& .${R.inset}`]:{paddingLeft:36},[`& .${O.root}`]:{minWidth:36}},!t.dense&&{[e.breakpoints.up("sm")]:{minHeight:"auto"}},t.dense&&y({minHeight:32,paddingTop:4,paddingBottom:4},e.typography.body2,{[`& .${O.root} svg`]:{fontSize:"1.25rem"}}))),me=u.exports.forwardRef(function(t,o){const i=Q({props:t,name:"MuiMenuItem"}),{autoFocus:d=!1,component:r="li",dense:l=!1,divider:c=!1,disableGutters:p=!1,focusVisibleClassName:f,role:C="menuitem",tabIndex:m,className:I}=i,$=z(i,ue),a=u.exports.useContext(G),n=u.exports.useMemo(()=>({dense:l||a.dense||!1,disableGutters:p}),[a.dense,l,p]),P=u.exports.useRef(null);Z(()=>{d&&P.current&&P.current.focus()},[d]);const j=y({},i,{dense:n.dense,divider:c,disableGutters:p}),k=fe(i),H=J(P,o);let S;return i.disabled||(S=m!==void 0?m:-1),s(G.Provider,{value:n,children:s(ge,y({ref:H,role:C,tabIndex:S,component:r,focusVisibleClassName:F(k.focusVisible,f),className:F(k.root,I)},$,{ownerState:j,classes:k}))})}),W=me,ve=async()=>{console.log("in getDialects");try{const{data:e,error:t}=await x.from("dialects").select("*");if(t){console.log("error:",t);return}else return e}catch(e){alert(e.message)}},be=async()=>{try{const{data:e,error:t}=await x.from("genders").select("*");if(t){console.log("error:",t);return}else return e}catch(e){alert(e.message)}},ye=async e=>{try{const{data:t,error:o}=await x.from("profiles").insert({id:e}).select().single();if(o)throw o;return t}catch(t){alert(t.message)}},xe=async e=>{try{const{user:t}=e,{data:o,error:i}=await x.from("profiles").select("*").eq("id",t.id);if(i){console.log("error:",i);return}else return o}catch(t){alert(t.message)}},he=async e=>{console.log("profile:",e);try{const{data:t,error:o}=await x.from("profiles").upsert({id:e.id,username:e.username,dialect:e.dialect,gender:e.gender,year:e.year}).select().single();if(o)throw o;return t}catch(t){alert(t.message)}},Ce=M({key:"profile",default:void 0}),Ie=()=>{const[e,t]=B(Ce);return{profile:e,setProfile:t}},$e=M({key:"dialects",default:void 0}),Pe=()=>{const[e,t]=B($e);return{dialects:e,setDialects:t}},ke=M({key:"genders",default:void 0}),we=()=>{const[e,t]=B(ke);return{genders:e,setGenders:t}};function Fe(){const[e,t]=u.exports.useState(!0),[o,i]=u.exports.useState(!1),{session:d}=ee(),{profile:r,setProfile:l}=Ie(),{dialects:c,setDialects:p}=Pe(),{genders:f,setGenders:C}=we(),[m]=te(),I=ae();u.exports.useEffect(()=>{d?xe(d).then(a=>{a!==void 0&&a.length!==0?l(a[0]):ye(d.user.id).then(n=>{n!==void 0&&l(n)})}):I(`${U}/login`),c===void 0&&ve().then(a=>{a!==void 0&&p(a)}),f===void 0&&be().then(a=>{a!==void 0&&C(a)})},[]),u.exports.useEffect(()=>{f!==void 0&&c!==void 0&&r!==void 0&&t(!1)},[f,c,r]);const $=async()=>{d!==null?(t(!0),he(r).then(()=>{i(!0),t(!1),m.get("origin")&&(window.location.href=`${U}${m.get("origin")}`)})):alert("not logged in")};return g(se,{children:[g(w,{sx:{maxWidth:"sm",width:"100%"},children:[s(le,{title:"Profile"}),s(w,{py:{sm:4,xs:2},children:s(re,{title:"Profile"})}),s(V,{m:2,children:s("div",{"aria-live":"polite",children:e?"Loading...":d?g(w,{children:[g(v,{container:!0,spacing:0,children:[s(v,{item:!0,xs:12,my:1,children:s(L,{fullWidth:!0,id:"username",label:"Username",name:"username",placeholder:"Your username",value:r.username!==void 0&&r.username!==null?r.username:"",onChange:a=>{l(n=>({...n,username:a.target.value}))}})}),s(v,{item:!0,xs:12,my:1,children:s(L,{fullWidth:!0,id:"year of birth",label:"Year of Birth",name:"year of birth",autoComplete:"year of birth",placeholder:"Your year of birth",value:r.year!==void 0&&r.year!==null?r.year:"",onChange:a=>{l(n=>({...n,year:parseInt(a.target.value)}))}})}),s(v,{item:!0,xs:12,my:1,children:g(T,{fullWidth:!0,children:[s(D,{id:"demo-simple-select-label",children:"Dialect"}),s(_,{labelId:"dialect",id:"dialect",value:r.dialect!==void 0&&r.dialect!==null?r.dialect:"",label:"dialect",onChange:a=>{l(n=>({...n,dialect:a.target.value}))},children:c?c.map(a=>s(W,{value:a.id,children:a.name},a.id)):""})]})}),s(v,{item:!0,xs:12,my:1,children:g(T,{fullWidth:!0,children:[s(D,{id:"demo-simple-select-label",children:"Gender"}),s(_,{labelId:"gender",id:"gender",value:r.gender!==void 0&&r.gender!==null?r.gender:"",label:"gender",onChange:a=>{l(n=>({...n,gender:a.target.value}))},children:f?f.map(a=>s(W,{value:a.id,children:a.name},a.id)):null})]})})]}),s(V,{sx:{width:"100%"},children:s(oe,{onClick:$,variant:"contained",sx:{mt:3,mb:2},disabled:e,children:"Update profile"})})]}):s("p",{children:"not logged in"})})})]}),o&&s(ie,{sx:{zIndex:9999,position:"fixed",top:"0",backgroundColor:"rgba(0,0,0,0.3)"},children:s(ne,{title:"Profile Updated",description:"Thank you for providing this information :-)",condition1:"",borderColor:"primary.main",buttons:[{text:"ok",color:"primary"}],onClick:()=>{i(!1)}})})]})}export{Fe as default};
